transformation amaltheaToAscet for
  amalthea <http://vitruv.tools/methodologisttemplate/amalthea>,
  ascet <http://vitruv.tools/methodologisttemplate/ascet>

import amalthea.ComponentContainer
import ascet.AscetModule

reaction ComponentContainerInsertedAsRoot on insert ComponentContainer {
  if (isRoot()) {
    call createAndRegisterRootComponentContainer(it)
  }
}

routine createAndRegisterRootComponentContainer(amaltheaComponentContainer : ComponentContainer) {
  precondition !exists(AscetModule | correspondence(amaltheaComponentContainer, it))

  create AscetModule ascetModule

  update {
    persist ascetModule at "/ascet-model/root.ascet"
    correspondence amaltheaComponentContainer, ascetModule
  }
}