transformation networkToGraph for
  network <http://vitruv.tools/methodologisttemplate/network>,
  graph <http://vitruv.tools/methodologisttemplate/graph>

import network.System
import graph.Root

reaction SystemInsertedAsRoot on insert System {
  triggers (System system) {
    system.isRoot()
  }
  
  effects {
    call createAndRegisterRoot(system)
  }
}

routine createAndRegisterRoot(System system) {
  guard {
    !exists(Root | it -> system)
  }
  
  create {
    Root newRoot
  }
  
  update {
    persist newRoot as "graph/root.graph"
    system -> newRoot
  }
}