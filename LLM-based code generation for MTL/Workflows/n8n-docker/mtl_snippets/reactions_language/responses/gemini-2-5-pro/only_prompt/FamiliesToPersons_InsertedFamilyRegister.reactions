import families.FamilyRegister
import persons.PersonRegister

transformation familiesToPersons for
	families : "http://vitruv.tools/methodologisttemplate/families",
	persons : "http://vitruv.tools/methodologisttemplate/persons"

reaction InsertedFamilyRegister on insert root element newFamilyRegister : FamilyRegister {
	call createPersonRegister(newFamilyRegister);
}

routine createPersonRegister(familyRegister : FamilyRegister) {
	guard {
		getCorrespondence(familyRegister, PersonRegister) == null
	}
	create {
		personRegister : PersonRegister
	}
	update {
		persist(personRegister, "persons/model.xmi");
		addCorrespondence(familyRegister, personRegister);
	}
}