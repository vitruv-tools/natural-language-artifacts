import "http://vitruv.tools/methodologisttemplate/network" as network using qualified names
import "http://vitruv.tools/methodologisttemplate/graph" as graph using qualified names
reactions: networkToGraph 
in reaction to changes in network 
execute actions in graph
reaction SystemInsertedAsRoot {
  after element network::System inserted as root
  call createAndRegisterRoot(a)
}
routine createAndRegisterRoot(network::System system) {
  match {
    require absence of graph::Root corresponding to system
  }
  create {
    val root = new graph::Root
  }
  update {
    persist(root).in("graph/" + system.hashCode + ".xmi")
    createCorrespondence(system, root)
  }
}