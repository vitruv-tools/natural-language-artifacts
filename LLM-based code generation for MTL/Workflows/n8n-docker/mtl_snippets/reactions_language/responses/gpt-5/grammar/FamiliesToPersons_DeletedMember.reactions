import org.eclipse.emf.ecore.util.EcoreUtil
import "http://vitruv.tools/methodologisttemplate/families" as families using qualified names
import "http://vitruv.tools/methodologisttemplate/persons" as persons using qualified names
reactions: familiesToPersons
in reaction to changes in families
execute actions in persons
reaction DeletedMember {
  after element families::Member deleted
  call deletePerson(element)
}
routine deletePerson(families::Member member) {
  match {
    val person = retrieve persons::Person corresponding to member
    val family = retrieve families::Family corresponding to member
  }
  update [
    if (person !== null) {
      EcoreUtil.remove(person)
    }
    this.removeCorrespondenceBetween(member, person)
    this.removeCorrespondenceBetween(member, family)
    this.removeCorrespondenceBetween(person, family)
  ]
}