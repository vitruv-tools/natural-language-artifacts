import "http://vitruv.tools/methodologisttemplate/families" as families
import "http://vitruv.tools/methodologisttemplate/persons" as persons

transformation familiesToPersons {
    between families and persons
    
    reaction DeletedMember {
        after element families::Member deleted
        call deletePerson(affectedEObject)
    }
    
    routine deletePerson(families::Member deletedMember) {
        match {
            val correspondingPerson = retrieve persons::Person corresponding to deletedMember
            val correspondingFamily = retrieve persons::Person corresponding to deletedMember.eContainer
        }
        update {
            remove object correspondingPerson
            remove correspondence between deletedMember and correspondingPerson
            remove correspondence between deletedMember.eContainer and correspondingFamily
        }
    }
}