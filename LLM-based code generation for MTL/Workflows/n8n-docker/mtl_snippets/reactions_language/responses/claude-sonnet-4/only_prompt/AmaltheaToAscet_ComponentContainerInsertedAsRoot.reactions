import "http://vitruv.tools/methodologisttemplate/amalthea" as amalthea
import "http://vitruv.tools/methodologisttemplate/ascet" as ascet

transformation amaltheaToAscet {
    between amalthea and ascet
    
    reaction ComponentContainerInsertedAsRoot {
        after element amalthea::ComponentContainer inserted as root
        call createAndRegisterRootComponentContainer(newValue)
    }
    
    routine createAndRegisterRootComponentContainer(amalthea::ComponentContainer componentContainer) {
        match {
            require absence of ascet::AscetModule corresponding to componentContainer
        }
        create {
            val ascetModule = new ascet::AscetModule
            add correspondence between componentContainer and ascetModule
            persistProjectRelative(ascetModule, componentContainer, "ascet")
        }
    }
}